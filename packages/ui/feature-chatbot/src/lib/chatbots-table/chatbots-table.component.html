<div class="ap-w-full ap-h-full ap-px-[30px] ap-pt-[50px]">
  <div class="ap-h-full">
    <div class="ap-py-4 ap-mb-4 ap-text-left ap-border-b-[1px] ap-font-semibold ap-typography-headline-6">
      <div class="ap-flex">Chatbot</div>
    </div>

    <div class="ap-min-h-[70%]">
      <table mat-table [dataSource]="dataSource" class="ap-w-[100%]" aria-label="Chatbots">
        <ng-container matColumnDef="displayName">
          <th mat-header-cell *matHeaderCellDef>Name</th>
          <td mat-cell *matCellDef="let chatbot">{{ chatbot.displayName }}</td>
        </ng-container>

        <ng-container matColumnDef="action">
          <th mat-header-cell *matHeaderCellDef class="!ap-text-center">
            <div class="ap-flex ap-justify-end">
              <ap-button btnColor="primary" btnSize="small" (buttonClicked)="createChatbot()">
                Create Chatbot
              </ap-button>
            </div>
          </th>
          <td mat-cell *matCellDef="let chatbot" class="!ap-text-center">
            <div class="ap-flex ap-gap-2 ap-items-center ap-justify-end">
              <ap-icon-button (click)="openSettings(chatbot.id)" tooltipText="Settings" iconFilename="settings.svg"
                color="primary" [width]="20" [height]="20" [height]="16"></ap-icon-button>
              <ap-icon-button (click)="openChatbot(chatbot.id)"
                [tooltipText]="chatbot.connectionId?'Chat with bot' : 'OpenAi connection is missing'"
                iconFilename="chat-bubble.svg" color="primary" [width]="20" [height]="20"
                [buttonDisabled]="!chatbot.connectionId" [height]="16"></ap-icon-button>
              <ap-icon-button (click)="deleteChatbot(chatbot)" tooltipText="Delete Bot" iconFilename="trash.svg"
                color="warn" [width]="20" [height]="20" [height]="16"></ap-icon-button>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row [class.ap-hidden]="dataSource.isLoading$ | async" *matRowDef="let row; columns: displayedColumns">
        </tr>
      </table>
      <ng-container *ngIf="(dataSource.isLoading$ | async) === true">
        <div class="ap-flex ap-items-center ap-justify-center ap-flex-grow ap-h-[500px]">
          <ap-loading-icon height="50px" width="51px" [outlineLoader]="true" [whiteLoader]="false">
          </ap-loading-icon>
        </div>
      </ng-container>
      <ng-container *ngIf="
          dataSource.data.length === 0 &&
          (dataSource.isLoading$ | async) === false
        ">
        <div class="ap-flex ap-items-center ap-justify-center ap-h-full ap-h-[500px]">
          No Chatbots Found
        </div>
      </ng-container>
    </div>
  </div>
</div>

<ng-container *ngIf="createBot$ | async"></ng-container>